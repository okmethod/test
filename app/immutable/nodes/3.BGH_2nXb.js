import{s as _,e as p,a as x,c as g,b as y,m as P,f as S,g as M,h as w,i as I,j as f,n as b,v as E,A as k,x as H}from"../chunks/scheduler.7YiWPMHY.js";import{S as R,i as B}from"../chunks/index.D5IxIBbb.js";async function D(s){const t=await W(s),{width:n,height:e}=t,i=document.createElement("canvas");i.width=n,i.height=e;const a=i.getContext("2d");if(!a)throw new Error("Canvas context could not be obtained");a.drawImage(t,0,0,n,e);const m=a.getImageData(0,0,n,e).data,u=[],c=new Set;function l(r,o){const v=(o*n+r)*4;return m[v+3]===0}function h(r,o){const v=`${r},${o}`;c.has(v)||(u.push({x:r,y:o}),c.add(v))}for(let r=0;r<e;r++)for(let o=0;o<n;o++)l(o,r)||((r===0||l(o,r-1))&&h(o,r),(r===e-1||l(o,r+1))&&h(o,r),(o===0||l(o-1,r))&&h(o,r),(o===n-1||l(o+1,r))&&h(o,r));return u}async function W(s){return new Promise((t,n)=>{const e=new Image;e.crossOrigin="Anonymous",e.src=s,e.onload=()=>t(e),e.onerror=i=>n(i)})}function V(){return Matter.Engine.create({enableSleeping:!0,positionIterations:6,velocityIterations:4,constraintIterations:6})}function A(){return Matter.Runner.create()}function C(s,t){return Matter.Render.create({element:t,engine:s,options:{width:t.clientWidth,height:t.clientHeight,pixelRatio:1,background:"#888888",hasBounds:!1,wireframes:!1,showSleeping:!1}})}function T(s,t){const n=Matter.Mouse.create(t.canvas);return t.mouse=n,Matter.MouseConstraint.create(s,{mouse:n,constraint:{stiffness:.2,damping:0,length:0,render:{visible:!0,lineWidth:2,strokeStyle:"#00ff00"}}})}async function j(s){const t=s.clientWidth,n=s.clientHeight,e=2e3,i=[Matter.Bodies.rectangle(t/2,-e/2,t,e,{isStatic:!0}),Matter.Bodies.rectangle(t/2,n+e/2,t,e,{isStatic:!0}),Matter.Bodies.rectangle(-e/2,n/2,e,n,{isStatic:!0}),Matter.Bodies.rectangle(t+e/2,n/2,e,n,{isStatic:!0})],a=["https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/1.png","https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/4.png","https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/7.png"],d=await Promise.all(a.map(async(m,u)=>{const c=await D(m);return Matter.Bodies.fromVertices(120+u*40,20,[c],{render:{sprite:{texture:m,xScale:1,yScale:1}}})}));return[...i,...d]}function L(s,t,n,e){function i(){e.isHolding=!0,Matter.World.add(s,t)}function a(){e.isHolding=!1,Matter.World.remove(s,t)}function d(){e.isHolding=!1,t.constraint.bodyA=null,t.constraint.bodyB=null,t.mouse.position={x:-1,y:-1},Matter.World.remove(s,t)}function m(u){const c=n.getBoundingClientRect();(u.clientX<c.left||u.clientX>c.right||u.clientY<c.top||u.clientY>c.bottom)&&Matter.World.remove(s,t)}return{pointerdown:i,pointerup:a,pointerleave:d,pointermove:m}}function $(s){let t,n,e='<h1 class="cTitleStyle md:!text-3xl">Example route</h1>',i,a,d,m="matter-js renderContainer",u,c;return{c(){t=p("div"),n=p("div"),n.innerHTML=e,i=x(),a=p("div"),d=p("span"),d.textContent=m,u=x(),c=p("div"),this.h()},l(l){t=g(l,"DIV",{class:!0});var h=y(t);n=g(h,"DIV",{class:!0,"data-svelte-h":!0}),P(n)!=="svelte-11znixk"&&(n.innerHTML=e),i=S(h),a=g(h,"DIV",{class:!0});var r=y(a);d=g(r,"SPAN",{"data-svelte-h":!0}),P(d)!=="svelte-tjtsqm"&&(d.textContent=m),u=S(r),c=g(r,"DIV",{class:!0}),y(c).forEach(M),r.forEach(M),h.forEach(M),this.h()},h(){w(n,"class","cTitlePartStyle md:!mb-4"),w(c,"class","w-80 h-80"),w(a,"class","cContentPartStyle !ml-4"),w(t,"class","cRouteBodyStyle")},m(l,h){I(l,t,h),f(t,n),f(t,i),f(t,a),f(a,d),f(a,u),f(a,c),s[1](c)},p:b,i:b,o:b,d(l){l&&M(t),s[1](null)}}}let O=!1;function q(s,t,n){let e,i,a,d,m,u;E(async()=>{i=V(),a=A(),d=C(i,e),m=T(i,d);const l=await j(e);{Matter.World.add(i.world,l),Matter.Runner.run(a,i),Matter.Render.run(d);let h=L(i.world,m,e,{isHolding:O});Object.entries(h).forEach(([r,o])=>{e.addEventListener(r,o)})}}),k(()=>{Matter.Render.stop(d),Matter.Runner.stop(a),Matter.World.clear(i.world,!1),Matter.Engine.clear(i),Object.entries(u).forEach(([l,h])=>{e.removeEventListener(l,h)})});function c(l){H[l?"unshift":"push"](()=>{e=l,n(0,e)})}return[e,c]}class z extends R{constructor(t){super(),B(this,t,q,$,_,{})}}export{z as component};
