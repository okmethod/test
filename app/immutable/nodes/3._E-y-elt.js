import{s as b,e as m,a as y,c as v,b as M,m as S,f as P,g as f,h as g,i as _,j as p,n as w,v as E,A as I,x}from"../chunks/scheduler.7YiWPMHY.js";import{S as H,i as A}from"../chunks/index.D5IxIBbb.js";async function B(s){const e=await k(s),n=cv.imread(e),t=new cv.Mat;cv.cvtColor(n,t,cv.COLOR_RGBA2BGRA);const r=new cv.Mat,a=new cv.MatVector;cv.split(t,a);const o=a.get(3);cv.threshold(o,r,0,255,cv.THRESH_BINARY);const u=new cv.MatVector,c=new cv.Mat;cv.findContours(r,u,c,cv.RETR_EXTERNAL,cv.CHAIN_APPROX_SIMPLE);const i=u.get(0),l=[];for(let d=0;d<i.data32S.length;d+=2)l.push({x:i.data32S[d],y:i.data32S[d+1]});return n.delete(),t.delete(),r.delete(),u.delete(),c.delete(),a.delete(),o.delete(),l}async function k(s){return new Promise((e,n)=>{const t=new Image;t.crossOrigin="Anonymous",t.src=s,t.onload=()=>e(t),t.onerror=r=>n(r)})}function C(){return Matter.Engine.create({enableSleeping:!0,positionIterations:6,velocityIterations:4,constraintIterations:6})}function V(){return Matter.Runner.create()}function W(s,e){return Matter.Render.create({element:e,engine:s,options:{width:e.clientWidth,height:e.clientHeight,pixelRatio:1,background:"#888888",hasBounds:!1,wireframes:!1,showSleeping:!1}})}function L(s,e){const n=Matter.Mouse.create(e.canvas);return e.mouse=n,Matter.MouseConstraint.create(s,{mouse:n,constraint:{stiffness:.2,damping:0,length:0,render:{visible:!0,lineWidth:2,strokeStyle:"#00ff00"}}})}async function T(s){const e=s.clientWidth,n=s.clientHeight,t=2e3,r=[Matter.Bodies.rectangle(e/2,-t/2,e,t,{isStatic:!0}),Matter.Bodies.rectangle(e/2,n+t/2,e,t,{isStatic:!0}),Matter.Bodies.rectangle(-t/2,n/2,t,n,{isStatic:!0}),Matter.Bodies.rectangle(e+t/2,n/2,t,n,{isStatic:!0})],a=["https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/1.png","https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/4.png","https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/7.png"],o=await Promise.all(a.map(async(u,c)=>{const i=await B(u);return Matter.Bodies.fromVertices(120+c*40,20,[i],{render:{sprite:{texture:u,xScale:1,yScale:1}}})}));return[...r,...o]}function D(s,e,n,t){function r(){t.isHolding=!0,Matter.World.add(s,e)}function a(){t.isHolding=!1,Matter.World.remove(s,e)}function o(){t.isHolding=!1,e.constraint.bodyA=null,e.constraint.bodyB=null,e.mouse.position={x:-1,y:-1},Matter.World.remove(s,e)}function u(c){const i=n.getBoundingClientRect();(c.clientX<i.left||c.clientX>i.right||c.clientY<i.top||c.clientY>i.bottom)&&Matter.World.remove(s,e)}return{pointerdown:r,pointerup:a,pointerleave:o,pointermove:u}}function O(s){let e,n,t='<h1 class="cTitleStyle md:!text-3xl">Example route</h1>',r,a,o,u="matter-js renderContainer",c,i;return{c(){e=m("div"),n=m("div"),n.innerHTML=t,r=y(),a=m("div"),o=m("span"),o.textContent=u,c=y(),i=m("div"),this.h()},l(l){e=v(l,"DIV",{class:!0});var d=M(e);n=v(d,"DIV",{class:!0,"data-svelte-h":!0}),S(n)!=="svelte-11znixk"&&(n.innerHTML=t),r=P(d),a=v(d,"DIV",{class:!0});var h=M(a);o=v(h,"SPAN",{"data-svelte-h":!0}),S(o)!=="svelte-tjtsqm"&&(o.textContent=u),c=P(h),i=v(h,"DIV",{class:!0}),M(i).forEach(f),h.forEach(f),d.forEach(f),this.h()},h(){g(n,"class","cTitlePartStyle md:!mb-4"),g(i,"class","w-80 h-80"),g(a,"class","cContentPartStyle !ml-4"),g(e,"class","cRouteBodyStyle")},m(l,d){_(l,e,d),p(e,n),p(e,r),p(e,a),p(a,o),p(a,c),p(a,i),s[1](i)},p:w,i:w,o:w,d(l){l&&f(e),s[1](null)}}}let j=!1;function N(s,e,n){let t,r,a,o,u,c;E(async()=>{r=C(),a=V(),o=W(r,t),u=L(r,o);const l=await T(t);{Matter.World.add(r.world,l),Matter.Runner.run(a,r),Matter.Render.run(o);let d=D(r.world,u,t,{isHolding:j});Object.entries(d).forEach(([h,R])=>{t.addEventListener(h,R)})}}),I(()=>{Matter.Render.stop(o),Matter.Runner.stop(a),Matter.World.clear(r.world,!1),Matter.Engine.clear(r),Object.entries(c).forEach(([l,d])=>{t.removeEventListener(l,d)})});function i(l){x[l?"unshift":"push"](()=>{t=l,n(0,t)})}return[t,i]}class q extends H{constructor(e){super(),A(this,e,N,O,b,{})}}export{q as component};
